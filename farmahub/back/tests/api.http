### ==============================================
### CONFIGURAÇÕES GERAIS
### ==============================================
@baseUrl = http://localhost:3000

@farmaceuticoToken = eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6MSwiZW1haWwiOiJqb2FvQGZhcm1hLmNvbSIsInJvbGUiOiJmYXJtYWNldXRpY28iLCJpYXQiOjE3NjM1MTk5MzksImV4cCI6MTc2MzYwNjMzOX0.gfwJzzyiq2k8cfg5ylsLD0YCG3Ai8RRmqLGRHo5Zg_4

@compradorToken = eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6NCwiZW1haWwiOiJiYXJiYXJhQGdtYWlsLmNvbSIsInJvbGUiOiJjb21wcmFkb3IiLCJpYXQiOjE3NjM1MjM0NDAsImV4cCI6MTc2MzYwOTg0MH0.FzG8XhNP0_BGo1XlS8jRwVdEmJPvXKxFWh2D_t77wYE

### ==============================================
### 1. AUTENTICAÇÃO (AUTH)
### ==============================================

### 1.1 Registrar Farmacêutico
POST {{baseUrl}}/auth/registro
Content-Type: application/json

{
  "nome": "João Farmacêutico",
  "email": "joao@farma.com",
  "senha": "123456",
  "role": "farmaceutico"
}

### 1.2 Registrar Comprador
POST {{baseUrl}}/auth/registro
Content-Type: application/json

{
  "nome": "Ana Compradora",
  "email": "ana@gmail.com",
  "senha": "123456",
  "role": "comprador"
}

### 1.3 [ERRO] Registrar com email inválido
POST {{baseUrl}}/auth/registro
Content-Type: application/json

{
  "nome": "Teste",
  "email": "emailerrado",
  "senha": "123456"
}

### 1.4 Login Farmacêutico
POST {{baseUrl}}/auth/login
Content-Type: application/json

{
  "email": "joao@farma.com",
  "senha": "123456"
}

### 1.5 Login Comprador
POST {{baseUrl}}/auth/login
Content-Type: application/json

{
  "email": "ana@gmail.com",
  "senha": "123456"
}

### 1.6 Logout de comprador (Invalida o token atual)
POST {{baseUrl}}/auth/logout
Authorization: Bearer {{compradorToken}}


### ==============================================
### 2. PRODUTOS (CRUD)
### ==============================================

### 2.1 Criar Produto 1 (Farmacêutico)
POST {{baseUrl}}/produtos
Authorization: Bearer {{farmaceuticoToken}}
Content-Type: application/json

{
  "nome": "Paracetamol 750mg",
  "apresentacao": "Caixa com 20 comprimidos",
  "fabricante": "Medley",
  "tipo": "medicamento",
  "preco": 12.50,
  "quantidade": 100
}

### 2.2 Criar Produto 2 (Farmacêutico - Para testes de carrinho)
POST {{baseUrl}}/produtos
Authorization: Bearer {{farmaceuticoToken}}
Content-Type: application/json

{
  "nome": "Protetor Solar FPS 50",
  "apresentacao": "200ml",
  "fabricante": "Nivea",
  "tipo": "cosmetico",
  "preco": 45.90,
  "quantidade": 50
}

### 2.3 [ERRO] Comprador tentando criar produto (403 Forbidden)
POST {{baseUrl}}/produtos
Authorization: Bearer {{compradorToken}}
Content-Type: application/json

{
  "nome": "Produto Hacker",
  "preco": 1.00
}

### 2.4 [ERRO] Validação de Schema (Preço negativo)
POST {{baseUrl}}/produtos
Authorization: Bearer {{farmaceuticoToken}}
Content-Type: application/json

{
  "nome": "Erro Schema",
  "tipo": "medicamento",
  "preco": -10.00,
  "quantidade": 10
}

### 2.5 Listar Produtos
# O Comprador verá lista vazia pois o controller filtra por user_id do logado.
GET {{baseUrl}}/produtos
Authorization: Bearer {{farmaceuticoToken}}

### 2.6 Buscar Produto Específico por ID (Público/Autenticado)
GET {{baseUrl}}/produtos/1
Authorization: Bearer {{compradorToken}}

### 2.7 Atualizar Produto (Apenas Dono/Farmacêutico)
PATCH {{baseUrl}}/produtos/1
Authorization: Bearer {{farmaceuticoToken}}
Content-Type: application/json

{
  "nome": "Paracetamol 750mg (Oferta)",
  "preco": 9.99
}

### 2.8 Deletar Produto (Apenas Dono/Farmacêutico)
# Vai apagar o ID 1. Use o ID 2 para os testes de carrinho abaixo.
DELETE {{baseUrl}}/produtos/1
Authorization: Bearer {{farmaceuticoToken}}


### ==============================================
### 3. FAVORITOS
### ==============================================

### 3.1 Adicionar aos Favoritos (Usando produto ID 2)
POST {{baseUrl}}/favoritos
Authorization: Bearer {{compradorToken}}
Content-Type: application/json

{
  "produto_id": 2
}

### 3.2 [ERRO] Tentar favoritar de novo o mesmo produto
POST {{baseUrl}}/favoritos
Authorization: Bearer {{compradorToken}}
Content-Type: application/json

{
  "produto_id": 2
}

### 3.3 Listar Favoritos
GET {{baseUrl}}/favoritos
Authorization: Bearer {{compradorToken}}

### 3.4 Remover Favorito
# Passar o ID DO PRODUTO na URL, não o ID do favorito
DELETE {{baseUrl}}/favoritos/2
Authorization: Bearer {{compradorToken}}


### ==============================================
### 4. CARRINHO
### ==============================================

### 4.1 Adicionar ao Carrinho (Usando produto ID 2)
POST {{baseUrl}}/carrinho
Authorization: Bearer {{compradorToken}}
Content-Type: application/json

{
  "produto_id": 2
}

### 4.2 Listar Carrinho
GET {{baseUrl}}/carrinho
Authorization: Bearer {{compradorToken}}

### 4.3 [ERRO] Adicionar produto duplicado
POST {{baseUrl}}/carrinho
Authorization: Bearer {{compradorToken}}
Content-Type: application/json

{
  "produto_id": 2
}

### 4.4 [ERRO] Produto Inexistente
POST {{baseUrl}}/carrinho
Authorization: Bearer {{compradorToken}}
Content-Type: application/json

{
  "produto_id": 9999
}

### 4.5 Remover do Carrinho
# Atenção: Passar o ID DO PRODUTO na URL
DELETE {{baseUrl}}/carrinho/2
Authorization: Bearer {{compradorToken}}

### 4.6 Verificar Carrinho Vazio
GET {{baseUrl}}/carrinho
Authorization: Bearer {{compradorToken}}


### ==============================================
### 5. PEDIDO
### ==============================================

### 5.1 Listar itens do Carrinho que serão comprados em Pedido
GET {{baseUrl}}/carrinho
Authorization: Bearer {{compradorToken}}

### 5.2 Criar pedido (Comprador)
POST {{baseUrl}}/pedido
Authorization: Bearer {{compradorToken}}
Content-Type: application/json

{
  "endereco": "Guara Rua 43, Quadra 18",
  "metodo_pag": "cartao"
}

### 5.3 [ERRO] Criar pedido com atributo not null vazio
POST {{baseUrl}}/pedido
Authorization: Bearer {{compradorToken}}
Content-Type: application/json

{
  "endereco": "",
  "metodo_pag": "cartao"
}

### 5.4 [ERRO] Criar pedido com método de pagamento inválido
POST {{baseUrl}}/pedido
Authorization: Bearer {{compradorToken}}
Content-Type: application/json

{
  "endereco": "Àguas Claras Quadra 17, Rua 10",
  "metodo_pag": "boleto"
}

### 5.5 Listar itens do Carrinho depois de fazer pedido (deve estar vazio)
GET {{baseUrl}}/carrinho
Authorization: Bearer {{compradorToken}}


### ==============================================
### 6. FARMACÊUTICO LISTA PEDIDOS
### ==============================================


### 6.1 Criar Produtos para serem comprados (Farmacêutico)
POST {{baseUrl}}/produtos
Authorization: Bearer {{farmaceuticoToken}}
Content-Type: application/json

{
  "nome": "Ibuprofeno 600mg",
  "apresentacao": "Blister com 10 comprimidos",
  "fabricante": "Generico Lab",
  "tipo": "medicamento",
  "preco": 15.99,
  "quantidade": 20
}

### 6.1
POST {{baseUrl}}/produtos
Authorization: Bearer {{farmaceuticoToken}}
Content-Type: application/json

{
  "nome": "Água Oxigenada",
  "apresentacao": "Frasco 100ml",
  "fabricante": "Generico Lab",
  "tipo": "conveniencia",
  "preco": 8.60,
  "quantidade": 35
}

### 6.1
POST {{baseUrl}}/produtos
Authorization: Bearer {{farmaceuticoToken}}
Content-Type: application/json

{
  "nome": "Teste COVID-19 Antígeno",
  "apresentacao": "Caixa com 2 Kits",
  "fabricante": "Roche Diagnostics",
  "tipo": "medicamento",
  "preco": 128.50,
  "quantidade": 25
}

### 6.2 Registrar Compradores para comprar
POST {{baseUrl}}/auth/registro
Content-Type: application/json

{
  "nome": "Rodrigo Comprador",
  "email": "rodrigo@gmail.com",
  "senha": "123456",
  "role": "comprador"
}

### 6.2
POST {{baseUrl}}/auth/registro
Content-Type: application/json

{
  "nome": "Bárbara Compradora",
  "email": "barbara@gmail.com",
  "senha": "123456",
  "role": "comprador"
}

### 6.3 Processo de compra (Rodrigo)

### Faça login como Rodrigo, insira o token gerado em compradorToken (no início do arquivo)
POST {{baseUrl}}/auth/login
Content-Type: application/json

{
  "email": "rodrigo@gmail.com",
  "senha": "123456"
}

### Autenticado como Rodrigo, adicionar ao carrinho
POST {{baseUrl}}/carrinho
Authorization: Bearer {{compradorToken}}
Content-Type: application/json

{
  "produto_id": 3
}

### Autenticado como Rodrigo, criar pedido
POST {{baseUrl}}/pedido
Authorization: Bearer {{compradorToken}}
Content-Type: application/json

{
  "endereco": "W3 Oeste, Quadra 600",
  "metodo_pag": "pix"
}

### 6.4 Processo de compra (Bárbara)

### Faça login como Bárbara, insira o token gerado em compradorToken (no início do arquivo)
POST {{baseUrl}}/auth/login
Content-Type: application/json

{
  "email": "barbara@gmail.com",
  "senha": "123456"
}

### Autenticado como Bárbara, adicionar ao carrinho
POST {{baseUrl}}/carrinho
Authorization: Bearer {{compradorToken}}
Content-Type: application/json

{
  "produto_id": 4
}

### Autenticado como Bárbara, criar pedido
POST {{baseUrl}}/pedido
Authorization: Bearer {{compradorToken}}
Content-Type: application/json

{
  "endereco": "W3 Leste, Quadra 900",
  "metodo_pag": "pix"
}


### 6.5 Autenticado como Farmacêutico, Listar Pedidos
GET {{baseUrl}}/pedido/farmaceutico
Authorization: Bearer {{farmaceuticoToken}}


