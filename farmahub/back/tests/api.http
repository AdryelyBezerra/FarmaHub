### ==============================================
### CONFIGURAÇÕES GERAIS
### ==============================================
@baseUrl = http://localhost:3000

@farmaceuticoToken = eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6MywiZW1haWwiOiJqb2FvQGZhcm1hLmNvbSIsInJvbGUiOiJmYXJtYWNldXRpY28iLCJpYXQiOjE3NjI5NjkxOTAsImV4cCI6MTc2MzA1NTU5MH0.b6WQviGRdkQQJB5bwGkP2oclhxe_Kq3roMJGHGk7Dao
@compradorToken = eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6NCwiZW1haWwiOiJhbmFAZ21haWwuY29tIiwicm9sZSI6ImNvbXByYWRvciIsImlhdCI6MTc2MzAwNDEwMCwiZXhwIjoxNzYzMDkwNTAwfQ.KZETdzavyVgu9dANSIuI5_MPPOm8EX22pWmW4KXHpZM


### ==============================================
### 1. AUTENTICAÇÃO (AUTH)
### ==============================================

### 1.1 Registrar Farmacêutico
POST {{baseUrl}}/auth/registro
Content-Type: application/json

{
  "nome": "João Farmacêutico",
  "email": "joao@farma.com",
  "senha": "123456",
  "role": "farmaceutico"
}

### 1.2 Registrar Comprador
POST {{baseUrl}}/auth/registro
Content-Type: application/json

{
  "nome": "Ana Compradora",
  "email": "ana@gmail.com",
  "senha": "123456",
  "role": "comprador"
}

### 1.3 [ERRO] Registrar com email inválido
POST {{baseUrl}}/auth/registro
Content-Type: application/json

{
  "nome": "Teste",
  "email": "emailerrado",
  "senha": "123456"
}

### 1.4 Login Farmacêutico
POST {{baseUrl}}/auth/login
Content-Type: application/json

{
  "email": "joao@farma.com",
  "senha": "123456"
}

### 1.5 Login Comprador
POST {{baseUrl}}/auth/login
Content-Type: application/json

{
  "email": "ana@gmail.com",
  "senha": "123456"
}

### 1.6 Logout de comprador (Invalida o token atual)
POST {{baseUrl}}/auth/logout
Authorization: Bearer {{compradorToken}}


### ==============================================
### 2. PRODUTOS (CRUD)
### ==============================================

### 2.1 Criar Produto 1 (Farmacêutico)
POST {{baseUrl}}/produtos
Authorization: Bearer {{farmaceuticoToken}}
Content-Type: application/json

{
  "nome": "Paracetamol 750mg",
  "apresentacao": "Caixa com 20 comprimidos",
  "fabricante": "Medley",
  "tipo": "medicamento",
  "preco": 12.50,
  "quantidade": 100
}

### 2.2 Criar Produto 2 (Farmacêutico - Para testes de carrinho)
POST {{baseUrl}}/produtos
Authorization: Bearer {{farmaceuticoToken}}
Content-Type: application/json

{
  "nome": "Protetor Solar FPS 50",
  "apresentacao": "200ml",
  "fabricante": "Nivea",
  "tipo": "cosmetico",
  "preco": 45.90,
  "quantidade": 50
}

### 2.3 [ERRO] Comprador tentando criar produto (403 Forbidden)
POST {{baseUrl}}/produtos
Authorization: Bearer {{compradorToken}}
Content-Type: application/json

{
  "nome": "Produto Hacker",
  "preco": 1.00
}

### 2.4 [ERRO] Validação de Schema (Preço negativo)
POST {{baseUrl}}/produtos
Authorization: Bearer {{farmaceuticoToken}}
Content-Type: application/json

{
  "nome": "Erro Schema",
  "tipo": "medicamento",
  "preco": -10.00,
  "quantidade": 10
}

### 2.5 Listar Produtos
# O Comprador verá lista vazia pois o controller filtra por user_id do logado.
GET {{baseUrl}}/produtos
Authorization: Bearer {{farmaceuticoToken}}

### 2.6 Buscar Produto Específico por ID (Público/Autenticado)
GET {{baseUrl}}/produtos/1
Authorization: Bearer {{compradorToken}}

### 2.7 Atualizar Produto (Apenas Dono/Farmacêutico)
PUT {{baseUrl}}/produtos/1
Authorization: Bearer {{farmaceuticoToken}}
Content-Type: application/json

{
  "nome": "Paracetamol 750mg (Oferta)",
  "preco": 9.99
}

### 2.8 Deletar Produto (Apenas Dono/Farmacêutico)
# Vai apagar o ID 1. Use o ID 2 para os testes de carrinho abaixo.
DELETE {{baseUrl}}/produtos/1
Authorization: Bearer {{farmaceuticoToken}}


### ==============================================
### 3. FAVORITOS
### ==============================================

### 3.1 Adicionar aos Favoritos (Usando produto ID 2)
POST {{baseUrl}}/favoritos
Authorization: Bearer {{compradorToken}}
Content-Type: application/json

{
  "produto_id": 2
}

### 3.2 [ERRO] Tentar favoritar de novo o mesmo produto
POST {{baseUrl}}/favoritos
Authorization: Bearer {{compradorToken}}
Content-Type: application/json

{
  "produto_id": 2
}

### 3.3 Listar Favoritos
GET {{baseUrl}}/favoritos
Authorization: Bearer {{compradorToken}}

### 3.4 Remover Favorito
# Passar o ID DO PRODUTO na URL, não o ID do favorito
DELETE {{baseUrl}}/favoritos/2
Authorization: Bearer {{compradorToken}}


### ==============================================
### 4. CARRINHO
### ==============================================

### 4.1 Adicionar ao Carrinho (Usando produto ID 2)
POST {{baseUrl}}/carrinho
Authorization: Bearer {{compradorToken}}
Content-Type: application/json

{
  "produto_id": 2
}

### 4.2 Listar Carrinho
GET {{baseUrl}}/carrinho
Authorization: Bearer {{compradorToken}}

### 4.3 [ERRO] Adicionar produto duplicado
POST {{baseUrl}}/carrinho
Authorization: Bearer {{compradorToken}}
Content-Type: application/json

{
  "produto_id": 2
}

### 4.4 [ERRO] Produto Inexistente
POST {{baseUrl}}/carrinho
Authorization: Bearer {{compradorToken}}
Content-Type: application/json

{
  "produto_id": 9999
}

### 4.5 Remover do Carrinho
# Atenção: Passar o ID DO PRODUTO na URL
DELETE {{baseUrl}}/carrinho/2
Authorization: Bearer {{compradorToken}}

### 4.6 Verificar Carrinho Vazio
GET {{baseUrl}}/carrinho
Authorization: Bearer {{compradorToken}}


### ==============================================
### 5. PEDIDO
### ==============================================

### 5.1 Listar itens do Carrinho que serão comprados em Pedido
GET {{baseUrl}}/carrinho
Authorization: Bearer {{compradorToken}}

### 5.2 Criar pedido (Comprador)
POST {{baseUrl}}/pedido
Authorization: Bearer {{compradorToken}}
Content-Type: application/json

{
  "endereco": "Guara Rua 43, Quadra 18",
  "metodo_pag": "cartao"
}

### 5.3 [ERRO] Criar pedido com atributo not null vazio
POST {{baseUrl}}/pedido
Authorization: Bearer {{compradorToken}}
Content-Type: application/json

{
  "endereco": "",
  "metodo_pag": "cartao"
}

### 5.4 [ERRO] Criar pedido com método de pagamento inválido
POST {{baseUrl}}/pedido
Authorization: Bearer {{compradorToken}}
Content-Type: application/json

{
  "endereco": "Àguas Claras Quadra 17, Rua 10",
  "metodo_pag": "boleto"
}

### 5.5 Listar itens do Carrinho depois de fazer pedido (deve estar vazio)
GET {{baseUrl}}/carrinho
Authorization: Bearer {{compradorToken}}
